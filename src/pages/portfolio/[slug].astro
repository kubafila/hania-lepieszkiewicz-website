---
import {Image} from "astro:assets";
import {getCollection, render} from 'astro:content';
const locale = Astro.currentLocale ?? 'pl';
import { marked } from 'marked';

const pageCollection = await getCollection('pagePortfolio');
import Layout from "../../layouts/Layout.astro";
const pageData = pageCollection[0].data[locale]
import DOMPurify from 'isomorphic-dompurify';
export async function getStaticPaths() {
  const locale = Astro.currentLocale ?? 'pl';
  const pageCollection = await getCollection('pagePortfolio');
  const pageData = pageCollection[0].data[locale]
  return pageData.items.map(item => ({params: {slug: item.slug}}))
}

const {slug} = Astro.params;


const data = pageData.items.find(item => item.slug === slug)
const renderHTMLFromMarkdown = (markdownText) =>
  DOMPurify.sanitize(marked.parse(markdownText));
---
<style lang="scss">

  .image{
    height: auto;
      width: 100%;
    object-fit: contain;
      margin-bottom: 2rem;
      border-radius: 12px;

  }
  .image-wrapper{
      border-radius: 12px;
      overflow: hidden;
      max-width: 600px;
  }
.text-wrapper{
    max-width: 60ch;
}
</style>
<Layout>

    <h2 transition:name="title">{data.title}</h2>
    <div class="image-wrapper">

    <Image transition:name={slug} src={data.image} alt="Portert Hani" class="image"/>
    </div>
    <div class="text-wrapper">
    <Fragment set:html={renderHTMLFromMarkdown(data.description ?? "")} />

    </div>
</Layout>